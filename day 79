class Solution:
    
    def findMatch(self, mat, word, x, y, wIdx):
        WLen = len(word)
        n = len(mat)
        m = len(mat[0])
        
        # base case
        if wIdx == WLen:
            return True
        
        # boundary conditions
        if x < 0 or y < 0 or x >= n or y >= m:
            return False
        
        # mismatch check
        if mat[x][y] != word[wIdx]:
            return False
        
        # temporarily mark as visited
        temp = mat[x][y]
        mat[x][y] = '#'
        
        # check all 4 directions
        res = (self.findMatch(mat, word, x - 1, y, wIdx + 1) or 
               self.findMatch(mat, word, x + 1, y, wIdx + 1) or
               self.findMatch(mat, word, x, y - 1, wIdx + 1) or
               self.findMatch(mat, word, x, y + 1, wIdx + 1))
        
        # backtrack
        mat[x][y] = temp
        
        return res

    def isWordExist(self, mat, word):
        WLen = len(word)
        n = len(mat)
        m = len(mat[0])
        
        if WLen > n * m:
            return False
        
        for i in range(n):
            for j in range(m):
                if mat[i][j] == word[0]:
                    if self.findMatch(mat, word, i, j, 0):
                        return True
        return False
